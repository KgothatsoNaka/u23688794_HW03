@model u23688794_HW03.Models.HomeViewModel
@{
    ViewBag.Title = "Home Page";
}

<div class="container-fluid">
    <div class="row">
        <!-- Header Section -->
        <div class="col-12">
            <h1 class="display-4 text-center mb-4">BlkeStores - Bicycle Sales Management</h1>
            <p class="lead text-center">Comprehensive bicycle sales management solution</p>
        </div>
    </div>

    <!-- Staff Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h3 class="card-title mb-0">
                        <i class="fas fa-users mr-2"></i>Staff Members
                        <span class="badge badge-light text-primary ml-2">@Model.StaffList.Count</span>
                    </h3>
                    <button type="button" class="btn btn-light btn-sm" data-toggle="modal" data-target="#createStaffModal">
                        <i class="fas fa-plus"></i> Create New Staff
                    </button>
                </div>
                <div class="card-body">
                    @if (Model.StaffList.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Store</th>
                                        <th>Manager</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var staff in Model.StaffList)
                                    {
                                        var manager = Model.StaffList.FirstOrDefault(s => s.staff_id == staff.manager_id);

                                        <tr>
                                            <td>@staff.first_name @staff.last_name</td>
                                            <td>@staff.email</td>
                                            <td>@staff.phone</td>
                                            <td>@(staff.stores != null ? staff.stores.store_name : "N/A")</td>
                                            <td>@(manager != null ? manager.first_name + " " + manager.last_name : "None")</td>
                                            <td>
                                                <span class="badge @(staff.active == 1 ? "badge-success" : "badge-secondary")">
                                                    @(staff.active == 1 ? "Active" : "Inactive")
                                                </span>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle mr-2"></i>No staff members found.
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Customers Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                    <h3 class="card-title mb-0">
                        <i class="fas fa-user-friends mr-2"></i>Customers
                        <span class="badge badge-light text-success ml-2">@Model.CustomerList.Count</span>
                    </h3>
                    <button type="button" class="btn btn-light btn-sm" data-toggle="modal" data-target="#createCustomerModal">
                        <i class="fas fa-plus"></i> Create New Customer
                    </button>
                </div>
                <div class="card-body">
                    @if (Model.CustomerList.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Address</th>
                                        <th>City</th>
                                        <th>State</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var customer in Model.CustomerList)
                                    {
                                        <tr>
                                            <td>@customer.first_name @customer.last_name</td>
                                            <td>@customer.email</td>
                                            <td>@(string.IsNullOrEmpty(customer.phone) ? "N/A" : customer.phone)</td>
                                            <td>@customer.street</td>
                                            <td>@customer.city</td>
                                            <td>@customer.state</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle mr-2"></i>No customers found.
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Products Section -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                    <h3 class="card-title mb-0">
                        <i class="fas fa-bicycle mr-2"></i>Products (Bicycles)
                        <span class="badge badge-light text-info ml-2">@Model.ProductList.Count</span>
                    </h3>
                </div>
                <div class="card-body">
                    <!-- Filter Section -->
                    <div class="row mb-3">
                        <div class="col-md-8">
                            @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { @class = "row", @id = "filterForm" }))
                            {
                                <div class="col-md-4 form-group">
                                    <label for="brandFilter" class="form-label">Filter by Brand:</label>
                                    <select class="form-control" id="brandFilter" name="brandFilter">
                                        <option value="">All Brands</option>
                                        @foreach (var brand in Model.Brands)
                                        {
                                            <option value="@brand" selected="@(brand == Model.SelectedBrand)">@brand</option>
                                        }
                                    </select>
                                </div>
                                <div class="col-md-4 form-group">
                                    <label for="categoryFilter" class="form-label">Filter by Category:</label>
                                    <select class="form-control" id="categoryFilter" name="categoryFilter">
                                        <option value="">All Categories</option>
                                        @foreach (var category in Model.Categories)
                                        {
                                            <option value="@category" selected="@(category == Model.SelectedCategory)">@category</option>
                                        }
                                    </select>
                                </div>
                                <div class="col-md-4 form-group d-flex align-items-end">
                                    <div class="btn-group w-100">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-filter mr-1"></i>Apply Filters
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="resetFilters()">
                                            <i class="fas fa-times mr-1"></i>Clear
                                        </button>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>

                    <!-- Products Table -->
                    @if (Model.ProductList.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Product Name</th>
                                        <th>Brand</th>
                                        <th>Category</th>
                                        <th>Model Year</th>
                                        <th>Price</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var product in Model.ProductList)
                                    {
                                        <tr>
                                            <td>@product.product_name</td>
                                            <td>@product.BrandName</td>
                                            <td>@product.CategoryName</td>
                                            <td>@product.model_year</td>
                                            <td class="font-weight-bold text-success">@product.list_price.ToString("C")</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle mr-2"></i>No products found matching the selected filters.
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Create Staff Modal -->
<div class="modal fade" id="createStaffModal" tabindex="-1" role="dialog" aria-labelledby="createStaffModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="createStaffModalLabel">
                    <i class="fas fa-user-plus mr-2"></i>Create New Staff Member
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- You can load your Staff Create partial view here -->
                <div class="text-center p-4">
                    <i class="fas fa-users fa-3x text-muted mb-3"></i>
                    <p class="text-muted">Staff creation form will be loaded here. Use your existing Staff controller Create view.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    <i class="fas fa-times mr-1"></i>Close
                </button>
                <a href="@Url.Action("Create", "Staff")" class="btn btn-primary">
                    <i class="fas fa-plus mr-1"></i>Create Staff
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Create Customer Modal -->
<div class="modal fade" id="createCustomerModal" tabindex="-1" role="dialog" aria-labelledby="createCustomerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title" id="createCustomerModalLabel">
                    <i class="fas fa-user-plus mr-2"></i>Create New Customer
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- You can load your Customer Create partial view here -->
                <div class="text-center p-4">
                    <i class="fas fa-user-friends fa-3x text-muted mb-3"></i>
                    <p class="text-muted">Customer creation form will be loaded here. Use your scaffolded Customer controller Create view.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    <i class="fas fa-times mr-1"></i>Close
                </button>
                <a href="@Url.Action("Create", "Customers")" class="btn btn-success">
                    <i class="fas fa-plus mr-1"></i>Create Customer
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function resetFilters() {
            document.getElementById('brandFilter').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('filterForm').submit();
        }

        // Initialize tooltips for Bootstrap 4
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
}